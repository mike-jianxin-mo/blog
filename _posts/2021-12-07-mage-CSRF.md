---
title: Magento - CSRF
author: Mike Mo
date: 2021-12-07
category: Magento
layout: post
---

### Controller CSRF
Ref: https://markshust.com/2019/01/29/bypass-csrf-form-validation-for-magento-post-submissions/

Rewrite the files:
```
/**
* @inheritDoc
*/
public function createCsrfValidationException(
    RequestInterface $request
): ?InvalidRequestException {
    return null;
}

/**
* @inheritDoc
*/
public function validateForCsrf(RequestInterface $request): ?bool
{
    return true;
}
```

### Admin URL CSRF 
1. Login to Site Admin URL (e.g., your website.com/admin)
2. Click on Stores > Configuration > ADVANCED > Admin > Security > Add Secret Key to URLs
3. Select YES from the dropdown options.
4. Click on Save Config at top.

Using this you can prevent CSRF attacks in Backend and your URL contains secret key/value pair at suffix.